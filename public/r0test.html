<HTML>
	<HEAD>
		<script>

			if(typeof(EventSource) == "undefined") {
				alert("EventSource is not supported on your browser!");
			} else {
				var source = new EventSource('http://fresto1.owlab.com:9999/r0Stream');
				//
				source.addEventListener('message', function(e) {

					console.log(e.data);
					var uiEvent = JSON.parse(e.data);
					//console.log(uiEvent.stage);
					//document.getElementById('paper').innerHTML = e.data;
					var logArea = document.getElementById('logArea');
					var total = ((logArea.value ? logArea.value + "\n" : "") + e.data).split("\n");
					if(total.length > 24)
						total = total.slice(total.length - 24);
					logArea.value = total.join("\n");
					
				}, false);

				source.addEventListener('open', function(e) {
					// Connection was opened.
				}, false);

				source.addEventListener('error', function(e) {
					if(e.readState == EventSource.CLOSED) {
						// Connection was closed.
					}
				}, false);
			}

		</script>
	</HEAD>
	<BODY>
		<H1 id="Section">Event Stream Viewer</H1>
		<textarea id="logArea" cols=300 rows=24></textarea>
	</BODY>
</HTML>
